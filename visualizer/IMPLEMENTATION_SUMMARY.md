# 可视化器模块 - 实现总结

## 概述

可视化器模块已成功实现，包含四个核心绘图函数，为MEG信号处理提供全面的可视化功能。所有函数遵循MATLAB最佳实践，并包含广泛的自定义选项。

## 已实现函数

### 1. plot_psd.m
**用途:** 绘制功率谱密度曲线

**特性**:
- 支持单通道和多通道
- dB和线性刻度选项
- 频率范围选择
- 通道标签和图例
- 可自定义线宽和样式

**验证:** ✓ 使用合成数据测试
- 单通道绘图
- 多通道比较
- 线性和dB刻度
- 频率范围过滤

### 2. plot_time_series.m
**用途:** 绘制时域信号

**特性**:
- 支持单通道和多通道
- 叠加和堆叠显示模式
- 通道选择
- 时间范围选择
- 自动通道标签
- 堆叠图的可自定义间距

**验证:** ✓ 使用合成数据测试
- 单通道绘图
- 多通道叠加显示
- 堆叠多通道显示
- 时间范围选择

### 3. plot_averaged_response.m
**用途:** 绘制总平均诱发响应

**特性**:
- 触发点标记 (t=0)
- 支持单通道和多通道
- 叠加和堆叠显示模式
- 可自定义触发标记 (颜色、样式)
- 通道选择和标签

**验证:** ✓ 使用合成诱发响应数据测试
- 单通道总平均
- 多通道叠加显示
- 堆叠多通道显示
- 触发标记自定义

### 4. plot_convergence_curve.m
**用途:** 绘制收敛性分析结果

**特性**:
- 相关系数随试次绘图
- 阈值线标记
- 自动最少试次检测
- 可自定义阈值
- 清晰的数据点标记

**验证:** ✓ 使用合成收敛数据测试
- 基本收敛曲线
- 自定义阈值标记
- 最少试次检测
- 可选标记显示

## 测试

### 测试套件 (test_visualizer.m)
所有函数的全面测试覆盖:
- ✓ 测试了所有4个函数
- ✓ 创建了14个测试图形
- ✓ 所有测试通过
- ✓ 验证了各种输入配置

### 演示脚本 (demo_visualizer.m)
使用真实MEG数据的交互式演示:
- ✓ 创建了11个演示图形
- ✓ 覆盖了所有可视化场景
- ✓ 真实的合成MEG信号
- ✓ 演示了多个使用案例

## 需求覆盖

| 需求 | 函数 | 状态 |
|-------------|----------|--------|
| 7.1 - PSD绘图 | plot_psd.m | ✓ 完成 |
| 7.2 - 时域绘图 | plot_time_series.m | ✓ 完成 |
| 7.3 - 平均响应绘图 | plot_averaged_response.m | ✓ 完成 |
| 7.4 - 收敛曲线绘图 | plot_convergence_curve.m | ✓ 完成 |

## 代码质量

### 输入验证
- 所有函数使用inputParser进行健壮的参数处理
- 带有详细消息的全面错误检查
- 所有输入的维度验证
- 数值参数的范围验证

### 文档
- 带有语法和示例的完整函数头
- 复杂逻辑的内联注释
- 带有使用模式和示例的README
- 实现总结 (本文档)

### 灵活性
- 所有函数支持单通道和多通道数据
- 通过名称-值对进行广泛自定义
- 用于子图集成的可选图形句柄参数
- 所有可选参数的自动默认值

## 使用示例

### 基本使用
```matlab
% PSD绘图
[f, psd] = compute_psd(signal, 4800);
plot_psd(f, psd);

% 时间序列
plot_time_series(time, data);

% 总平均
plot_averaged_response(trial_times, grand_avg);

% 收敛性
plot_convergence_curve(n_trials, correlation);
```

### 高级使用
```matlab
% 多通道堆叠显示
plot_time_series(time, meg_data, ...
    'Channels', 1:8, ...
    'Stacked', true, ...
    'ChannelLabels', labels, ...
    'TimeRange', [0 2]);

% 带频率聚焦的PSD
plot_psd(f, psd, ...
    'FreqRange', [10 30], ...
    'Scale', 'dB', ...
    'Title', 'Alpha频段活动');

% 带自定义阈值的收敛性
plot_convergence_curve(n_trials, corr, ...
    'Threshold', 0.85, ...
    'MarkMinTrials', true);
```

## 与其他模块的集成

可视化器模块与以下模块无缝集成:
- **分析器模块:** 直接使用compute_psd输出
- **工具模块:** 与AnalysisResults数据结构兼容
- **所有处理模块:** 可以可视化任何处理过的MEG数据

## 性能

所有函数都针对以下方面进行了优化:
- 大型数据集 (使用10秒 @ 4800 Hz测试)
- 多通道 (使用8通道测试)
- 实时绘图 (最小开销)

## 未来增强 (可选)

未来开发的潜在添加:
1. 地形图 (需要通道布局信息)
2. 时频图 (频谱图)
3. 带数据光标的交互式绘图
4. 批量图形导出功能
5. 自定义配色方案和主题

## 结论

可视化器模块已完成并完全功能。所有四个所需的绘图函数都已实现、测试和文档化。该模块为MEG信号处理工作流提供灵活的出版质量可视化功能。

**状态:** ✓ 任务 10 完成
**日期:** 2026-02-03
**测试结果:** 所有测试通过
